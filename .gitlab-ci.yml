image: hseeberger/scala-sbt:11.0.3_1.2.8_2.12.8

stages:
  - test
  - release

test:
  stage: test
  script:
    - sbt clean test
  variables:
    CI: "true"

release on bintray:
  stage: release
  only:
    refs:
      - master
  script:
    - gpg --import  <(echo "$GITLAB_PGP_PRIVATE_KEY")
    - git secret reveal
    - source secrets-env.sh
    - sbt "release skip-tests with-defaults"